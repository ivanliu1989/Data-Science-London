setwd("C:\\Users\\Ivan.Liuyanfeng\\Desktop\\Data_Mining_Work_Space\\Data-Science-London")
library(glmnet)
x.test <- read.csv("Data/test.csv", header=F)
x <- read.csv("Data/train.csv", header=F)
y <- read.csv("Data/trainLabels.csv", header=F)
head(x.test)
head(x)
head(y)
str(x)
str(x.test)
x = x.train
y = x.trainLabels
alpha=1.0     # Lasso
f=glmnet(x=as.matrix(x), y=as.matrix(y), alpha=alpha, family="binomial")
summary(f)
plot(f)
plot(f, xvar="dev")   # Show graph of deviance
plot(f)
plot(f, xvar="dev")   # Show graph of deviance
cv = cv.glmnet(x=as.matrix(x), y=as.matrix(y), alpha=alpha, family="binomial")
cv
coef(f, cv$lambda.min)
coef(f, cv$lambda.1se)
predict(f, s=cv$lambda.1se, type="nonzero")
plot(cv)
title(sprintf("alpha=%.2f", alpha))
y.pred <- predict(f, s=cv$lambda.1se, newx=as.matrix(x), type="response")
y.pred
y.pred <- round( y.pred[,1])
y.pred
mean((y.pred-y)^2)
y.pred <- predict(f, s=cv$lambda.1se, newx=as.matrix(x.test), type="response")
y.pred <- round( y.pred[,1])
write.table(cbind(1:length(y.pred),y.pred), col.names=c("Id","Solution"), file="ypred_glmnet_10_1se.csv", row.names=F, sep=",")
png('Img/sprintf.png')
plot(cv)
title(sprintf("alpha=%.2f", alpha))
dev.off()
png('sprintf.png')
plot(cv)
title(sprintf("alpha=%.2f", alpha))
dev.off()
png('deviance.png')
plot(f, xvar="dev")   # Show graph of deviance
dev.off()
